<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <title>Python的PyAutoGUI库整理中文文档，可以让所有GUI都实现自动化。_wblylh的博客-CSDN博客_pyautogui中文文档</title>
  <script>
    (function () {
      var el = document.createElement("script");
      el.id = "ttzz";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(el, s);
    })(window)
  </script>


  <style>
    #content_views pre {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    #content_views pre code {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
  </style>


  <link rel="stylesheet" type="text/css" href="sandalstrap.min.css" tppabs="">
  <style>
    .MathJax,
    .MathJax_Message,
    .MathJax_Preview {
      display: none
    }
  </style>
</head>

<body class="nodata " style="">
  <script>
    var toolbarSearchExt = '{"landingWord":["pyautogui中文文档"],"queryWord":"PyAutoGUI文档","tag":["python"],"title":"Python的PyAutoGUI库整理中文文档，可以让所有GUI都实现自动化。"}';
  </script>


  <div class="main_father clearfix d-flex justify-content-center" style="height:100%;">
    <div class="container clearfix" id="mainBox">
      <main>
    </div>
  </div>
  </div>
  <article class="baidu_pl">
    <div id="article_content" class="article_content clearfix">
      <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block"
        style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
      </svg>
      <h2><a id="10__0"></a>1.0 简介</h2>
      <p><strong>1.1 目的</strong><br />
        PyAutoGUI是一个纯Python的GUI自动化工具&#xff0c;可以模拟鼠标的移动、点击、拖拽&#xff0c;键盘按键输入、按住操作&#xff0c;以及鼠标&#43;键盘的热键同时按住等操作&#xff0c;能完全代替手动操作。还能获取屏幕截图&#xff0c;像素的颜色&#xff0c;甚至简单的GUI对话框。多平台支持&#xff08;Windows&#xff0c;OS
        X&#xff0c;Linux&#xff09;。可以用pip安装&#xff0c;Github上有源代码。</p>
      <h2><a id="20__5"></a>2.0 安装与依赖</h2>
      <p>PyAutoGUI支持Python 2.x和Python 3.x&#xff0c;各系统安装方法如下&#xff1a;</p>
      <p><strong>Windows&#xff1a;</strong><br />
        PyAutoGUI没有任何依赖&#xff0c;因为它用Python的ctypes模块所以不需要pywin32&#xff0c;安装时只需要在cmd命令框中输入</p>
      <pre><code class="prism language-python">pip3 install pyautogui
</code></pre>
      <p><strong>OS X&#xff1a;</strong><br /> PyAutoGUI需要PyObjC运行AppKit和Quartz模块。这个模块在PyPI上的按住顺序是pyobjc-core和pyobjc<br />
        sudo pip3 install pyobjc-core<br /> sudo pip3 install pyobjc<br /> sudo pip3 install pyautogui</p>
      <p><strong>Linux&#xff1a;</strong><br /> PyAutoGUI需要python-xlib&#xff08;Python 2&#xff09;、python3-Xlib&#xff08;Python
        3&#xff09;<br /> sudo pip3 install python3-xlib<br /> sudo apt-get scrot<br /> sudo apt-get install
        python-tk<br /> sudo apt-get install python3-dev<br /> sudo pip3 install pyautogui</p>
      <h2><a id="30__29"></a>3.0 基本功能</h2>
      <p><strong>3.1pyautogui.size()获取屏幕分辨率</strong><br /> 屏幕位置使用X和Y轴的笛卡尔坐标系。原点(0,0)在左上角&#xff0c;分别向右、向下增大。<br />
        如果屏幕像素是1920*1080&#xff0c;那么右下角的坐标是(1919, 1079)。分辨率大小可以通过size()函数返回整数元组。未来将加入多屏支持。</p>
      <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>pyautogui<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 返回显示器的尺寸整数元组(x, y)。</span>
</code></pre>
      <p>Size(width&#61;1920, height&#61;1080)</p>
      <p><strong>3.2 position()鼠标位置</strong><br /> 光标的位置用position()返回。同样也是返回整数元组(x, y)&#xff0c;分别表示鼠标光标所在位置的XY轴坐标。</p>
      <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 返回整数元组(x, y)的鼠标位置</span>
</code></pre>
      <p>Point(x&#61;1798, y&#61;82)</p>
      <p><strong>3.3 onScreen(x, y)检查XY坐标是否在屏幕上</strong><br /> 屏幕位置(x, y)传入函数onScreen(x, y)返回布尔值True和False</p>
      <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>pyautogui<span class="token punctuation">.</span>onScreen<span class="token punctuation">(</span><span class="token number">1920</span><span class="token punctuation">,</span> <span class="token number">1080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
      <p>False</p>
      <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>pyautogui<span class="token punctuation">.</span>onScreen<span class="token punctuation">(</span><span class="token number">1919</span><span class="token punctuation">,</span> <span class="token number">1079</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
      <p>True</p>
      <p><strong>3.4 基本代码演示</strong></p>
      <pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui <span class="token comment"># 导入pyautogui库</span>
screenWidth<span class="token punctuation">,</span> screenHeight <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取屏幕尺寸</span>
pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>screenWidth <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> screenHeight <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 鼠标移动到屏幕中心</span>
currentMouseX<span class="token punctuation">,</span> currentMouseY <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取鼠标当前位置</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>currentMouseX<span class="token punctuation">,</span> currentMouseY<span class="token punctuation">)</span> <span class="token comment"># 打印鼠标位置&#xff0c;输出屏幕中心值</span>
</code></pre>
      <p>960 540</p>
      <p><strong>3.5保护措施</strong></p>
      <p><strong>3.5.1 PAUSE 更改默认的操作延迟时间&#xff0c;默认0.1秒</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>PAUSE <span class="token operator">&#61;</span> <span class="token number">2.5</span> <span class="token comment"># 更改操作延迟时间为2.5秒</span>
</code></pre>
      <p><strong>3.5.2 FAILSAFE把鼠标光标在屏幕左上角(0, 0)报错终止运</strong>行<br /> pyautogui.FAILSAFE &#61;
        True时&#xff0c;如果把鼠标光标在屏幕左上角&#xff0c;PyAutoGUI函数就会产生pyautogui.FailSafeException异常。用于终止程序运行&#xff0c;防止死循环。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>FAILSAFE <span class="token operator">&#61;</span> <span class="token boolean">True</span> <span class="token comment"># 鼠标光标在屏幕左上角&#xff0c;会导致程序异常&#xff0c;用于终止程序运行。</span>
</code></pre>
      <p><strong>3.5.3 另外对所有Python程序死循环都有效的Alt &#43; C热键也可以强制终止。</strong></p>
      <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Press Ctrl&#43;C to quit&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 提示按Ctrl&#43;C可以退出</span>
</code></pre>
      <h2><a id="4__94"></a>4. 鼠标函数</h2>
      <p><strong>4.1 moveTo()鼠标移动</strong></p>
      <p><strong>鼠标移动到绝对坐标</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment"># 移动到绝对坐标</span>
</code></pre>
      <p>坐标系的原点是左上角。X轴&#xff08;水平&#xff09;坐标向右增大&#xff0c;Y轴&#xff08;竖直&#xff09;坐标向下增大。。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 光标移动到(100, 200)位置</span>
</code></pre>
      <p>一般鼠标光标都是瞬间移动到指定的位置&#xff0c;如果你想让鼠标移动的慢点&#xff0c;可以通过参数duration控制移动时间</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> duration<span class="token operator">&#61;</span><span class="token number">1.2</span><span class="token punctuation">)</span> <span class="token comment"># 用1.2秒的时间把光标移动到(100, 200)绝对坐标位置</span>
</code></pre>
      <p><strong>鼠标移动到相对坐标</strong><br />
        以鼠标当前位置为原点&#xff0c;X轴&#xff08;横向&#xff09;向右移动&#xff0c;Y轴&#xff08;竖直&#xff09;向下移动&#xff0c;负值反方向移动。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>moveRel<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> duration<span class="token operator">&#61;</span><span class="token number">1.5</span><span class="token punctuation">)</span> <span class="token comment"># 从鼠标当前位置移动&#xff0c;向右50像素&#xff0c;向下100像素&#xff0c;移动鼠标用1.5秒的时间。</span>
</code></pre>
      <p><strong>4.2 click()鼠标点击</strong><br /> click()函数就是让鼠标先移动&#xff0c;再单击&#xff0c;默认是左键&#xff0c;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">,</span> duration<span class="token operator">&#61;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 先用2秒钟时间移动到(100, 200)再单击鼠标左键&#xff08;默认&#xff09;</span>
pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> clicks<span class="token operator">&#61;</span><span class="token number">3</span><span class="token punctuation">,</span> interval<span class="token operator">&#61;</span><span class="token number">0.25</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 先移动到绝对坐标&#xff08;50,100&#xff09;&#xff0c;单击3次&#xff0c;间隔0.25秒&#xff0c;鼠标右键</span>
</code></pre>
      <p>其中&#xff0c;button属性可以设置成left&#xff08;左键&#xff09;&#xff0c;middle&#xff08;中键&#xff09;和right&#xff08;右键&#xff09;。</p>
      <pre><code class="prism language-python">Pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span>right<span class="token punctuation">,</span>  duration<span class="token operator">&#61;</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token comment"># 绝对位置&#xff08;100&#xff0c; 200&#xff09;&#xff0c;单击鼠标右键 &#xff0c;移动鼠标用0.5秒的时间</span>
</code></pre>
      <p>为了操作方便&#xff0c;PyAutoGUI提供了rightClick(), middleClick,
        doubleClick()&#xff0c;tripleClick()和来实现右右键点击、中键点击、双击、三击的操作&#xff0c;可读性更好&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>rightClick<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 移动到绝对位置&#xff08;100, 200&#xff09;单击鼠标右键</span>
pyautogui<span class="token punctuation">.</span>middleClick<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 移动到绝对位置&#xff08;100, 200&#xff09;单击鼠标中键</span>
pyautogui<span class="token punctuation">.</span>doubleClick<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 移动到绝对位置&#xff08;100, 200&#xff09;双击鼠标</span>
pyautogui<span class="token punctuation">.</span>tripleClick<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 移动到绝对位置&#xff08;100, 200&#xff09;三击鼠标</span>
</code></pre>
      <p><strong>4.3 scroll()鼠标滚轮</strong><br /> scroll函数控制鼠标滚轮的滚动。正数向上滚动&#xff0c;负数向下滚动&#xff0c;只接收一个整数。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>scroll<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># 向下滚动10格</span>
</code></pre>
      <p>可以先移动&#xff0c;再滚动。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>scroll<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment"># 移动到(100, 100)位置&#xff0c;然后滚轮向上滚动10格</span>
</code></pre>
      <p><strong>4.4 按下mouseDown()和松开mouseUp()</strong><br /> 每个按键按下和松开两个事件可以分开处理&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>mouseDown<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span>
pyautogui<span class="token punctuation">.</span>mouseUp<span class="token punctuation">(</span>x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span>
pyautogui<span class="token punctuation">.</span>mouseUp<span class="token punctuation">(</span>button<span class="token operator">&#61;</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">,</span> x<span class="token operator">&#61;</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">&#61;</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 移动到(100, 200)位置&#xff0c;然后松开鼠标右键</span>
</code></pre>
      <p><strong>4.5 dragTo()拖拽</strong><br /> 拖拽的意思是&#xff1a;按下鼠标键并拖动鼠标。PyAutoGUI 提供了两个函数&#xff1a;dragTo()和
        dragRel()。它的参数和 moveTo()和 moveRel() 一样。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>dragTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 鼠标左键拖拽到屏幕“100&#xff0c;200”的位置</span>
pyautogui<span class="token punctuation">.</span>dragTo<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 鼠标左键用“2秒”拖拽到屏幕“300&#xff0c;400”的位置</span>
pyautogui<span class="token punctuation">.</span>dragRel<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 鼠标左键用“2秒”拖拽到相对当前位置右边30像素的位置</span>
pyautogui<span class="token punctuation">.</span>dragRel<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> duration<span class="token operator">&#61;</span><span class="token number">2</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 上面也可以写成这样</span>
</code></pre>
      <p><strong>4.6 移动速度渐变</strong><br />
        缓动/渐变函数可以改变光标移动过程的速度和方向。通常鼠标是匀速直线运动&#xff0c;这就是线性缓动/渐变函数。PyAutoGUI有30种缓动/渐变函数&#xff0c;可以通过pyautogui.ease*?查看。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> pyautogui<span class="token punctuation">.</span>easeInQuad<span class="token punctuation">)</span> <span class="token comment"># 开始很慢&#xff0c;不断加速</span>
pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> pyautogui<span class="token punctuation">.</span>easeOutQuad<span class="token punctuation">)</span> <span class="token comment"># 开始很快&#xff0c;不断减速</span>
pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> pyautogui<span class="token punctuation">.</span>easeInOutQuad<span class="token punctuation">)</span> <span class="token comment"># 开始和结束都快&#xff0c;中间比较慢</span>
pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> pyautogui<span class="token punctuation">.</span>easeInBounce<span class="token punctuation">)</span> <span class="token comment"># 一步一徘徊前进</span>
pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> pyautogui<span class="token punctuation">.</span>easeInElastic<span class="token punctuation">)</span> <span class="token comment"># 徘徊幅度更大&#xff0c;甚至超过起点和终点</span>
</code></pre>
      <h2><a id="5__189"></a>5. 键盘控制函数</h2>
      <p><strong>5.1 typewrite()字符输入</strong><br />
        键盘控制的主要函数就是typewrite()。这个函数可以实现字符输入。要在两次输入间增加时间间隔&#xff0c;可以用interval参数。typewrite()函数只能用于单个字符键&#xff0c;不能按SHITF和F1这些功能键。
      </p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>typewrite<span class="token punctuation">(</span><span class="token string">&#39;Hello world!&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 输入Hello world!</span>
pyautogui<span class="token punctuation">.</span>typewrite<span class="token punctuation">(</span><span class="token string">&#39;Hello world!&#39;</span><span class="token punctuation">,</span> interval<span class="token operator">&#61;</span><span class="token number">0.25</span><span class="token punctuation">)</span> <span class="token comment"># 每次输入间隔0.25秒&#xff0c;输入Hello world!</span>
pyautogui<span class="token punctuation">.</span>typewrite<span class="token punctuation">(</span><span class="token string">&#39;Hello world!\n&#39;</span><span class="token punctuation">,</span> interval<span class="token operator">&#61;</span><span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token comment"># 模拟按键依次键入Hello world!字符并换行&#xff08;\n&#xff09;&#xff0c;按键的时间间隔0.1秒。</span>
</code></pre>
      <p>多个按键连续输入可以列表的方式&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>typewrite<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;backspace&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;enter&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;f1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> interval<span class="token operator">&#61;</span><span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token comment"># 依然按列表中的按键&#xff0c;间隔0.1秒</span>
</code></pre>
      <p><strong>5.2 press()、keyDown()、keyUp()几种按键方式</strong><br />
        按下键盘按键&#xff0c;可以用press()函数把pyautogui.KEYBOARD_KEYS里面按键对应的字符串输入进去。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">&#39;esc&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 按一下键盘Esc键</span>
</code></pre>
      <p>和typewrite()函数一样&#xff0c;可以用数组把一组键传入press()。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 键盘上三次点击左方向键左箭头</span>
</code></pre>
      <p>press()函数其实按下然后松开两个动作。每个按键的按下和松开也可以单独调用&#xff0c;实际是press() 的拆分动作&#xff0c;是按下按键keyDown()和释放按键keyUp()函数的包装。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 按一次a</span>
</code></pre>
      <p>等价于&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>keyDown<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 按下a不释放</span>
pyautogui<span class="token punctuation">.</span>keyUp<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 释放a</span>
</code></pre>
      <p>适合组合使用&#xff1a;按住shift键&#xff0c;连续按3下左方向键&#xff0c;然后再松开shift键。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>keyDown<span class="token punctuation">(</span><span class="token string">&#39;shift&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 按下shift不释放</span>
pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 一次左方向键左箭头</span>
pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 二次左方向键左箭头</span>
pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 三次左方向键左箭头</span>
pyautogui<span class="token punctuation">.</span>keyUp<span class="token punctuation">(</span><span class="token string">&#39;shift&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 释放shift键</span>
</code></pre>
      <p>为了更高效的输入热键&#xff0c;PyAutoGUI提供了hotkey()函数&#xff0c;像Ctrl&#43;A或Ctrl&#43;Shift&#43;1都可以用hotkey()函数来实现&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">&#39;ctrl&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 全选</span>
</code></pre>
      <p>等价于&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>keyDown<span class="token punctuation">(</span><span class="token string">&#39;ctrl&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 按下Ctrl不释放</span>
pyautogui<span class="token punctuation">.</span>keyDown<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 按下a不释放</span>
pyautogui<span class="token punctuation">.</span>keyUp<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 释放a</span>
pyautogui<span class="token punctuation">.</span>keyUp<span class="token punctuation">(</span><span class="token string">&#39;ctrl&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 释放Ctrl键</span>
</code></pre>
      <p><strong>5.3下面就是press()&#xff0c;keyDown()&#xff0c;keyUp()和hotkey()函数可以输入的按键名称&#xff1a;</strong><br />
        print(pyautogui.KEYBOARD_KEYS)<br /> [’\t’, ‘\n’, ‘\r’, ’ ‘, ‘!’, ‘&#34;’, ‘#’, ‘$’, ‘%’, ‘&amp;’, &#34;’&#34;,
        ‘(’, ‘)’, ‘*’, ‘&#43;’, ‘,’, ‘-’, ‘.’, ‘/’, ‘0’, ‘1’, ‘2’, ‘3’, ‘4’, ‘5’, ‘6’, ‘7’, ‘8’, ‘9’, ‘:’, ‘;’, ‘&lt;’,
        ‘&#61;’, ‘&gt;’, ‘?’, ‘&#64;’, ‘[’, ‘\’, ‘]’, ‘^’, ‘_’, ‘&#96;’, ‘a’, ‘b’, ‘c’, ‘d’, ‘e’, ‘f’, ‘g’, ‘h’, ‘i’,
        ‘j’, ‘k’, ‘l’, ‘m’, ‘n’, ‘o’, ‘p’, ‘q’, ‘r’, ‘s’, ‘t’, ‘u’, ‘v’, ‘w’, ‘x’, ‘y’, ‘z’, ‘{’, ‘|’, ‘}’, ‘~’,
        ‘accept’, ‘add’, ‘alt’, ‘altleft’, ‘altright’, ‘apps’, ‘backspace’, ‘browserback’, ‘browserfavorites’,
        ‘browserforward’, ‘browserhome’, ‘browserrefresh’, ‘browsersearch’, ‘browserstop’, ‘capslock’, ‘clear’,
        ‘convert’, ‘ctrl’, ‘ctrlleft’, ‘ctrlright’, ‘decimal’, ‘del’, ‘delete’, ‘divide’, ‘down’, ‘end’, ‘enter’, ‘esc’,
        ‘escape’, ‘execute’, ‘f1’, ‘f10’, ‘f11’, ‘f12’, ‘f13’, ‘f14’, ‘f15’, ‘f16’, ‘f17’, ‘f18’, ‘f19’, ‘f2’, ‘f20’,
        ‘f21’, ‘f22’, ‘f23’, ‘f24’, ‘f3’, ‘f4’, ‘f5’, ‘f6’, ‘f7’, ‘f8’, ‘f9’, ‘final’, ‘fn’, ‘hanguel’, ‘hangul’,
        ‘hanja’, ‘help’, ‘home’, ‘insert’, ‘junja’, ‘kana’, ‘kanji’, ‘launchapp1’, ‘launchapp2’, ‘launchmail’,
        ‘launchmediaselect’, ‘left’, ‘modechange’, ‘multiply’, ‘nexttrack’, ‘nonconvert’, ‘num0’, ‘num1’, ‘num2’,
        ‘num3’, ‘num4’, ‘num5’, ‘num6’, ‘num7’, ‘num8’, ‘num9’, ‘numlock’, ‘pagedown’, ‘pageup’, ‘pause’, ‘pgdn’,
        ‘pgup’, ‘playpause’, ‘prevtrack’, ‘print’, ‘printscreen’, ‘prntscrn’, ‘prtsc’, ‘prtscr’, ‘return’, ‘right’,
        ‘scrolllock’, ‘select’, ‘separator’, ‘shift’, ‘shiftleft’, ‘shiftright’, ‘sleep’, ‘stop’, ‘subtract’, ‘tab’,
        ‘up’, ‘volumedown’, ‘volumemute’, ‘volumeup’, ‘win’, ‘winleft’, ‘winright’, ‘yen’, ‘command’, ‘option’,
        ‘optionleft’, ‘optionright’]<br /> 可以这样使用&#xff1a;</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>KEYBOARD_KEYS<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token comment"># 用列表的方式获取前10</span>
</code></pre>
      <p>[’\t’, ‘\n’, ‘\r’, ’ &#39;, ‘!’, ‘&#34;’, ‘#’, ‘$’, ‘%’, ‘&amp;’]</p>
      <h2><a id="6__268"></a>6. 消息弹窗函数</h2>
      <p>PyAutoGUI通过Tkinter实现了4种纯Python的消息弹窗函数&#xff0c;和JavaScript类似。<br /> <strong>6.1 alert()单按钮的消息弹窗</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>alert<span class="token punctuation">(</span>text<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> title<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> button<span class="token operator">&#61;</span><span class="token string">&#39;OK&#39;</span><span class="token punctuation">)</span> <span class="token comment">#显示一个简单的带文字和OK按钮的消息弹窗。用户点击后返回button的文字。 </span>
</code></pre>
      <p><strong>6.2 The confirm()多按钮的消息弹窗</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>confirm<span class="token punctuation">(</span>text<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> title<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> buttons<span class="token operator">&#61;</span><span class="token punctuation">[</span><span class="token string">&#39;OK&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Cancel&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 显示OK和Cancel按钮的消息弹窗。用户点击后返回button的文字。 </span>
pyautogui<span class="token punctuation">.</span>confirm<span class="token punctuation">(</span>text<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> title<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> buttons<span class="token operator">&#61;</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 显示0-9十个按键的消息弹窗。用户点击后返回button的文字。</span>
</code></pre>
      <p><strong>6.3 The prompt()可以输入的消息弹窗</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>prompt<span class="token punctuation">(</span>text<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> title<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span> <span class="token punctuation">,</span> default<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 可以输入的消息弹窗&#xff0c;带OK和Cancel按钮。用户点击OK按钮返回输入的文字&#xff0c;点击Cancel按钮返回None。</span>
</code></pre>
      <p><strong>6.4 The password() 可以输入密码的消息弹窗</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>password<span class="token punctuation">(</span>text<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> title<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> default<span class="token operator">&#61;</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> mask<span class="token operator">&#61;</span><span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 样式同prompt()&#xff0c;用于输入密码&#xff0c;消息用*表示。带OK和Cancel按钮。用户点击OK按钮返回输入的文字&#xff0c;点击Cancel按钮返回None。</span>
</code></pre>
      <h2><a id="7__296"></a>7. 截屏函数</h2>
      <p>
        PyAutoGUI用Pillow/PIL库实现图片相关的识别和操作。PyAutoGUI可以截屏并保存为图片文件&#xff0c;然后定位这些截屏在屏幕上的位置。与sikuli类似&#xff0c;把屏幕上的按键截取下来&#xff0c;然后定位&#xff0c;就可以执行点击等操作了。<br />
        截屏功能需要安装Pillow模块。OS X用screencapture命令&#xff0c;是系统自带的。Linux用户用scrot命令&#xff0c;可以通过sudo apt-get install
        scrot安装。<br />
        由于Ubuntu上安装Pillow时缺少PNG和JPEG依赖&#xff0c;所以安装比较复杂&#xff0c;具体可以看Ubuntu论坛。不过用miniconda可以解决这些问题&#xff0c;如果Ubuntu或Mint上安装了miniconda&#xff0c;可以直接conda
        install pillow来安装。</p>
      <p><strong>7.1 screenshot()截屏</strong><br />
        调用screenshot()将返回Image对象&#xff08;有关详细信息&#xff0c;请参阅Pillow或PIL模块文档&#xff09;。传递文件名字符串会将屏幕截图保存到文件中&#xff0c;并将其作为Image对象返回。
      </p>
      <pre><code class="prism language-python">im1 <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span>
im2 <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token string">&#39;my_screenshot.png&#39;</span><span class="token punctuation">)</span>
</code></pre>
      <p>在一个1920×1080的屏幕上&#xff0c;screenshot()函数要消耗100微秒——不快也不慢。</p>
      <pre><code class="prism language-python">im <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span>region<span class="token operator">&#61;</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span> <span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 如果不需要截取整个屏幕&#xff0c;还有一个可选的region参数。可以控制截取区域的左上角X、Y坐标值和宽度、高度的参数&#xff0c;用来截取。</span>
</code></pre>
      <p><strong>7.2 locateOnScreen()比较图片并定位</strong><br />
        如果你有一个图片文件想在上面做点击操作&#xff0c;你可以用locateOnScreen()函数来定位。就是和图片做简单的颜色对比&#xff0c;适合查找屏幕不固定按钮的位置。</p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span><span class="token string">&#39;looks.png&#39;</span><span class="token punctuation">)</span> <span class="token comment">#  找到会返回(最上角坐标x&#xff0c;y&#xff0c;宽度&#xff0c;高度)4个数值。如果有一个像素不匹配&#xff0c;它就会返回None。</span>
</code></pre>
      <p><strong>7.3 pyautogui.center()获取中心点</strong></p>
      <pre><code class="prism language-python">x<span class="token punctuation">,</span> y <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">643</span><span class="token punctuation">,</span> <span class="token number">745</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 获得中心点x,y的坐标</span>
</code></pre>
      <p><strong>7.4 locateCenterOnScreen()等价于上面的两步操作&#xff0c;直接获得图形的中心坐标&#xff1a;</strong></p>
      <pre><code class="prism language-python">x<span class="token punctuation">,</span> y <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>locateCenterOnScreen<span class="token punctuation">(</span><span class="token string">&#39;pyautogui/calc7key.png&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 获得图形的中心坐标x,y</span>
pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment"># 获取坐标后可以配合鼠标点击等操作</span>
</code></pre>
      <p>定位时间需要1~2秒&#xff0c;对即时游戏来说就太慢了&#xff0c;但是大多数情况下还是很好用的。</p>
      <p><strong>7.5 更多用法</strong><br /> 有几个“定位”功能。他们都开始查看屏幕的左上角&#xff08;或图像&#xff09;并向右看&#xff0c;然后向下看。<br />
        locateOnScreen(image, grayscale&#61;False)-
        返回image屏幕上第一个找到的实例的&#xff08;左&#xff0c;顶部&#xff0c;宽度&#xff0c;高度&#xff09;坐标。ImageNotFoundException如果在屏幕上找不到则会引发。<br />
        locateCenterOnScreen(image, grayscale&#61;False)-
        返回image屏幕上第一个找到的实例中心的&#xff08;x&#xff0c;y&#xff09;坐标。ImageNotFoundException如果在屏幕上找不到则会引发。<br />
        locateAllOnScreen(image, grayscale&#61;False) -
        返回一个生成器&#xff0c;该生成器生成&#xff08;左&#xff0c;顶部&#xff0c;宽度&#xff0c;高度&#xff09;元组&#xff0c;用于在屏幕上找到图像的位置。<br />
        locate(needleImage, haystackImage,
        grayscale&#61;False)-返回&#xff08;左&#xff0c;上&#xff0c;宽度&#xff0c;高度&#xff09;的第一坐标发现的实例needleImage在haystackImage。ImageNotFoundException如果在屏幕上找不到则会引发。<br />
        locateAll(needleImage, haystackImage, grayscale&#61;False)-
        返回一个生成器&#xff08;生成&#xff08;左&#xff0c;顶部&#xff0c;宽度&#xff0c;高度&#xff09;元组的位置needleImage&#xff09;haystackImage。<br />
        “locate all”函数可用于for循环或传递给list()&#xff1a;</p>
      <pre><code class="prism language-python"><span class="token keyword">for</span> pos <span class="token keyword">in</span> pyautogui<span class="token punctuation">.</span>locateAllOnScreen<span class="token punctuation">(</span><span class="token string">&#39;someButton.png&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span>
</code></pre>
      <p>(1101, 252, 50, 50)<br /> (59, 481, 50, 50)<br /> (1395, 640, 50, 50)<br /> (1838, 676, 50, 50)</p>
      <pre><code class="prism language-python"><span class="token builtin">list</span><span class="token punctuation">(</span>pyautogui<span class="token punctuation">.</span>locateAllOnScreen<span class="token punctuation">(</span><span class="token string">&#39;someButton.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
      <p>[(1101, 252, 50, 50), (59, 481, 50, 50), (1395, 640, 50, 50), (1838, 676, 50, 50)]</p>
      <p>
        这些“定位”功能费时&#xff0c;加速它们的最好方法是传递一个region参数&#xff08;4个整数元组&#xff08;左&#xff0c;顶部&#xff0c;宽度&#xff0c;高度&#xff09;&#xff09;来仅搜索屏幕的较小区域而不是全屏&#xff1a;
      </p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span><span class="token string">&#39;someButton.png&#39;</span><span class="token punctuation">,</span> region<span class="token operator">&#61;</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
      <p><strong>7.6 灰度值匹配</strong><br />
        可以传递参数grayscale&#61;True给locate函数&#xff0c;能提供轻微的加速&#xff08;大约30&#xff05;-ish&#xff09;。这会使图像和屏幕截图中的颜色去色&#xff0c;从而加快速度&#xff0c;但容易导致误判失误。
      </p>
      <pre><code class="prism language-python">button7location <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span><span class="token string">&#39;calc7key.png&#39;</span><span class="token punctuation">,</span> grayscale<span class="token operator">&#61;</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 去色对比</span>
</code></pre>
      <h2><a id="8__376"></a>8 像素匹配</h2>
      <p><strong>8.1要获取截屏某个位置的RGB像素值&#xff0c;可以用Image对象的getpixel()方法&#xff1a;</strong></p>
      <pre><code class="prism language-python">im <span class="token operator">&#61;</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 先获取屏幕截图</span>
im<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 再获取截图x,y的RGB值</span>
</code></pre>
      <p><strong>8.2 pixel()可以将前面两步封装在一起</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>pixel<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
</code></pre>
      <p><strong>8.3 pixelMatchesColor()如果你只是要检验一下指定位置的像素值&#xff0c;可以直接用x,y坐标和RGB颜色。返回True和False</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>pixelMatchesColor<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pyautogui<span class="token punctuation">.</span>pixelMatchesColor<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance<span class="token operator">&#61;</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># tolerance参数可以指定RGB颜色的误差范围</span>
</code></pre>
      <p><strong>8.4 不稳定的情况</strong></p>
      <pre><code class="prism language-python">pyautogui<span class="token punctuation">.</span>pixelMatchesColor<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 这样用&#xff0c;有时候不稳定。不规律的抛出错误</span>
</code></pre>
      <p>OSError: windll.user32.ReleaseDC failed : return 0</p>
      <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&#61;&#61;</span> <span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 可以改成这样使用</span>
</code></pre>
      <h2><a id="90__410"></a>9.0 安装错误的解决办法</h2>
      <p><strong>9.1 pip install pyautogui</strong><br /> 提示“UnicodeDecodeError: ‘gbk’ codec can’t decode byte
        0xa2”<br /> Using cached https://files.pythonhosted.org/packages/f1/54/740939161eb3471e8f7<br />
        75ce9b0fcac0e54c36bf63501e51f2cd7158f587d/PyGetWindow-0.0.3.tar.gz<br /> Complete output from command python
        setup.py egg_info:<br /> Traceback (most recent call last):<br /> File “”, line 1, in<br /> File
        “C:\Users\tedgame\AppData\Local\Temp\pip-install-tqy3ahwx\pygetwindow<br /> \setup.py”, line 11, in<br />
        long_description &#61; fh.read()<br /> UnicodeDecodeError: ‘gbk’ codec can’t decode byte 0xa2 in position 905:
        ille<br /> gal multibyte sequence<br /> 解决办法&#xff1a;pyautogui依赖的是pygetwindow<mark>0.04&#xff0c;先pip install
          pygetwindow</mark>0.0.1&#xff0c;再安装pyautogui</p>
      <p><strong>9.2 locateonscreen 函数无法添加confidence参数</strong><br /> 提示TypeError: _locateAll_python() got an unexpected
        keyword argument &#39;confidence<br /> 解决办法&#xff1a;需要先安装opencv<br /> pip install opencv-python</p>
      <h2><a id="100_PyAutoGUI_431"></a>10.0 PyAutoGUI键盘表的部分解释</h2>
      <p>‘\t’&#xff08;TAB制表符&#xff09;, ‘\n’&#xff08;换行符&#xff09;, ‘\r’,<br /> ’ ‘, ‘!’, ‘&#34;’, ‘#’, ‘$’, ‘%’, ‘&amp;’,
        &#34;’&#34;, ‘(’, ‘)’, ‘*’, ‘&#43;’, ‘,’, ‘-’, ‘.’, ‘/’, &#xff08;各种符号&#xff09;<br /> ‘0’, ‘1’, ‘2’, ‘3’, ‘4’,
        ‘5’, ‘6’, ‘7’, ‘8’, ‘9’, &#xff08;数字&#xff09;<br /> ‘:’, ‘;’, ‘&lt;’, ‘&#61;’, ‘&gt;’, ‘?’, ‘&#64;’, ‘[’, ‘\’,
        ‘]’, ‘^’, ‘_’, ‘&#96;’, &#xff08;各种符号&#xff09;<br /> ‘a’, ‘b’, ‘c’, ‘d’, ‘e’, ‘f’, ‘g’, ‘h’, ‘i’, ‘j’, ‘k’, ‘l’,
        ‘m’, ‘n’, ‘o’, ‘p’, ‘q’, ‘r’, ‘s’, ‘t’, ‘u’, ‘v’, ‘w’, ‘x’, ‘y’, ‘z’, &#xff08;26英文字符&#xff09;<br /> ‘{’, ‘|’,
        ‘}’, ‘~’, &#xff08;各种符号&#xff09;<br /> ‘accept’, ‘add’,<br /> ‘alt’, ‘altleft’, ‘altright’,
        &#xff08;Alt键&#xff0c;区分左、右&#xff09;<br /> ‘apps’,<br /> ‘backspace’&#xff08;Backspace退格键&#xff09;<br />
        ‘browserback’, ‘browserfavorites’, ‘browserforward’, ‘browserhome’, ‘browserrefresh’, ‘browsersearch’,
        ‘browserstop’, &#xff08;浏览器后退、收藏、前进、主页、刷新、搜索、停止&#xff09;<br /> ‘capslock’, &#xff08;CapsLock大小写锁定键&#xff09;<br />
        ‘clear’, ‘convert’,<br /> ‘ctrl’, ‘ctrlleft’, ‘ctrlright’, &#xff08;Ctrl键&#xff0c;区分左、右&#xff09;<br />
        ‘decimal’,<br /> ‘del’, ‘delete’, &#xff08;Delete键删除光标右边字符&#xff09;<br /> ‘divide’,<br /> ‘down’,
        &#xff08;下键头&#xff09;<br /> ‘end’, &#xff08;End键结尾&#xff09;<br /> ‘enter’, &#xff08;Enter回车键&#xff09;<br /> ‘esc’,
        ‘escape’, &#xff08;Esc键退出&#xff09;<br /> ‘execute’,<br /> ‘f1’, ‘f10’, ‘f11’, ‘f12’, ‘f13’, ‘f14’, ‘f15’, ‘f16’,
        ‘f17’, ‘f18’, ‘f19’, ‘f2’, ‘f20’, ‘f21’, ‘f22’, ‘f23’, ‘f24’, ‘f3’, ‘f4’, ‘f5’, ‘f6’, ‘f7’, ‘f8’, ‘f9’,
        &#xff08;F1-F23功能键&#xff09;<br /> ‘final’,<br /> ‘fn’, &#xff08;Fn键&#xff09;<br /> ‘hanguel’, ‘hangul’, ‘hanja’,
        ‘help’,<br /> ‘home’, &#xff08;Home键&#xff09;<br /> ‘insert’, &#xff08;Insert键&#xff09;<br /> ‘junja’, ‘kana’,
        ‘kanji’, ‘launchapp1’, ‘launchapp2’, ‘launchmail’, ‘launchmediaselect’,<br /> ‘left’, &#xff08;左箭头&#xff09;<br />
        ‘modechange’, ‘multiply’, ‘nexttrack’, ‘nonconvert’,<br /> ‘num0’, ‘num1’, ‘num2’, ‘num3’, ‘num4’, ‘num5’,
        ‘num6’, ‘num7’, ‘num8’, ‘num9’, &#xff08;数字小键盘0-9键&#xff09;<br /> ‘numlock’, &#xff08;数字小键盘锁定键&#xff09;<br />
        ‘pagedown’, ‘pageup’, &#xff08;PageDown键下翻一页&#xff0c;PageUp键上翻一页&#xff0c;&#xff09;<br /> ‘pause’,
        &#xff08;Pause暂停键&#xff09;<br /> ‘pgdn’, ‘pgup’, ‘playpause’, ‘prevtrack’,<br /> ‘print’, ‘printscreen’,
        &#xff08;Prt Scr键&#xff09;<br /> ‘prntscrn’, ‘prtsc’, ‘prtscr’, ‘return’,<br /> ‘right’, &#xff08;右箭头&#xff09;<br />
        ‘scrolllock’, &#xff08;Scroll Lock键&#xff09;<br /> ‘select’, ‘separator’,<br /> ‘shift’, ‘shiftleft’,
        ‘shiftright’, &#xff08;Shift键&#xff0c;区分左、右&#xff09;<br /> ‘sleep’, &#xff08;Sleep睡眠键&#xff09;<br /> ‘stop’,
        ‘subtract’, ‘tab’,<br /> ‘up’, &#xff08;上箭头&#xff09;<br /> ‘volumedown’, ‘volumemute’, ‘volumeup’,
        &#xff08;音量-、静音、音量&#43;&#xff09;<br /> ‘win’, ‘winleft’, ‘winright’, &#xff08;Win键&#xff0c;区分左、右&#xff09;<br />
        ‘yen’,<br /> ‘command’, &#xff08;苹果Command键&#xff09;<br /> ‘option’, ‘optionleft’, ‘optionright’
        &#xff08;苹果Option键&#xff0c;区分左、右&#xff09;</p>
    </div>
    </div>
    <div id="treeSkill"></div>
  </article>

  <script>
    $(function () {
      setTimeout(function () {
        var mathcodeList = document.querySelectorAll('.htmledit_views img.mathcode');
        if (mathcodeList.length > 0) {
          var testImg = new Image();
          testImg.onerror = function () {
            mathcodeList.forEach(function (item) {
              $(item).before('<span class="img-codecogs">\\(' + item.alt + '\\)</span>');
              $(item).remove();
            })
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
          }
          testImg.src = mathcodeList[0].src;
        }
      }, 1000)
    })